# Clipto Database Schema Documentation
**Extracted:** 2026-01-21  
**Source:** Dexie.js v42 (Clipto Desktop v7.2.17)

---

## üìä Database Architecture

### Technology Stack
- **Local Storage:** Dexie.js (IndexedDB wrapper)
- **Schema Version:** 42
- **Browser API:** IndexedDB (embedded in Electron)

### Android Comparison
- **Mobile Tech:** ObjectBox (NoSQL)
- **Compatibility:** High (Mapped Fields)
- **Mapping:**
  - `clips` ‚Üî `ClipBox`
  - `users` ‚Üî `UserBox`
  - `filters` ‚Üî `FilterBox`
  - `settings` ‚Üî `SettingsBox`
  - `fileRefs` ‚Üî `FileRefBox`


---

## üìã Complete Schema (v42)

### Table: `clips` (Core Notes/Snippets)
**Purpose:** Stores all user notes, snippets, and clippings

**Indexes:**
- `++id` - Auto-increment primary key
- `createDate` - Creation timestamp
- `modifyDate` - Last modification timestamp
- `text` - Note content (searchable)
- `firestoreId` - Legacy Firebase sync ID
- `snippetId` - Unique snippet identifier
- `snippet` - Boolean: is this a snippet?
- `deleted` - Boolean: soft delete flag
- `textType` - Content type (text/markdown/code)
- `*tagIds` - Multi-entry index for tags
- `tagIdsCount` - Number of tags
- `*snippetSetsIds` - Multi-entry for snippet collections
- `snippetSetsIdsCount` - Collection count
- `tracked` - Boolean: pinned/tracked item
- `fav` - Boolean: favorite flag
- `filesCount` - Attached file count

**Compound Indexes:**
- `[tagIdsCount+deleted]`
- `[tracked+deleted]`
- `[fav+deleted]`
- `[snippet+deleted]`
- `[tracked+deleted+fav+tagIdsCount+snippetSetsIdsCount+filesCount+snippet+title]`

---

### Table: `tags`
**Purpose:** User-created tags/categories

**Indexes:**
- `++id` - Auto-increment primary key

**Likely Fields:** name, color, icon (inferred)

---

### Table: `fileRefs`
**Purpose:** File attachments metadata

**Indexes:**
- `++id` - Auto-increment primary key
- `name` - Filename
- `folder` - Directory path
- `path` - Full file path
- `firestoreId` - Legacy Firebase ID
- `deleted` - Soft delete flag
- `[path+name]` - Compound path index

---

### Table: `users`
**Purpose:** User accounts (multi-user support)

**Indexes:**
- `++id` - Auto-increment primary key
- `firebaseId` - Firebase authentication ID

---

### Table: `filters`
**Purpose:** Saved search/filter configurations

**Indexes:**
- `++id` - Auto-increment primary key
- `uid` - User ID (owner)
- `type` - Filter type

---

### Table: `settings`
**Purpose:** Application configuration

**Indexes:**
- `++id` - Auto-increment primary key

---

### Table: `publicLinks`
**Purpose:** Shared note links

**Indexes:**
- `++id` - Auto-increment primary key
- `uid` - User ID (owner)

---

## üîç Key Observations

### Data Model Insights
1. **Soft Deletes:** Uses `deleted` flag instead of hard deletes (data recoverable)
2. **Multi-Entry Indexes:** `*tagIds` and `*snippetSetsIds` allow many-to-many relationships
3. **Firebase Legacy:** `firestoreId` fields indicate previous cloud sync architecture
4. **Performance Optimization:** Heavy use of compound indexes for common queries

### Sync Implications
- **Cannot sync files directly:** IndexedDB is browser-native (binary format)
- **Must use export/import:** Need to serialize to JSON for cross-device sync
- **127 potential export functions:** Likely includes built-in import/export logic

---

## üéØ Recommended Sync Strategy

### Option A: Built-In Export Logic (Preferred)
**Hypothesis:** Clipto likely has import/export functions already implemented

**Next Steps:**
1. Search 127 export candidate files for actual export functions
2. Locate the export format (likely JSON)
3. Build "Sync Bridge" that:
   - Calls Clipto's export function ‚Üí saves to OneDrive
   - Android app calls import function ‚Üê reads from OneDrive

### Option B: Custom Exporter
If no built-in export found, create:
```javascript
// Pseudo-code
async function exportAllData() {
  const db = new Dexie('clipto');
  const data = {
    clips: await db.clips.toArray(),
    tags: await db.tags.toArray(),
    fileRefs: await db.fileRefs.toArray(),
    // ... etc
  };
  return JSON.stringify(data);
}
```

---

## üìù Android Comparison Needed

**Next Phase:** Clone Android source and compare SQLite schema to this IndexedDB schema.

**Questions to Answer:**
- Do Android table names match? (`clips`, `tags`, etc.)
- Are field names compatible?
- Can Android import this JSON format?

---

**Generated by QKlipto Phase 2.3 - Schema Extraction**
